<header class="logout">
  <div class="toframe">
    <button class="button1 btn2" (click)="changePwd()">
      modifier mot de passe
  </button>
    <button class=" button1 btn1" (click)="onLogout()">
      logout
  </button>
  <button type="button" class="btn-close close1" aria-label="Close" (click)="closeModal()"></button>
  </div>
</header>

<div class=" reduce">
  <div class="card bg-grd p-2 fs-7 text-white fw-bold text-center">
    Plan d’action des unités médicales mobiles (UMM)
</div>
<h5 class="h5">
  Détails du plan d'action
</h5>
<div class="toCenter">
<form class="form-container" [formGroup]="myressoure" (ngSubmit)="getRessourcesData()">
  <div class="form" >
    <h5 class="pop">
      <mat-icon class="people">directions_car</mat-icon>
      Population à couvrir par l'équipe mobile
    </h5>
    <h5 class="pop circle-icon">
      <u>Information sur les ressource :</u>
    </h5>
      <span>Année</span>
      <input placeholder="valeur" type="date" class="input2" formControlName="year" required>
      <h5 class="pop circle-icon">
        <u>Information sur le vehicule :</u>
      </h5>
      <span>Vehicule id</span>
      <input placeholder="valeur" type="number" class="input2" formControlName="vehicule_id" required>
      <span>Type de vehicule</span>
      <input placeholder="valeur"  type="text" class="input2" formControlName="vehicule_type" required>
      <span>Vehicule age</span>
      <input placeholder="valeur" type="number" class="input2" formControlName="vehicule_age" required>
      <h5 class="pop circle-icon">
        <u>Information sur le Budget :</u>
      </h5>
      <span>Budget id</span>
      <input placeholder="valeur" type="number" class="input2" formControlName="budget_id" required>
      <span>Budget des besoins Carburant</span>
      <input placeholder="valeur"  type="number" step="0.01" class="input2" formControlName="budget_besoinCarburant" required>
      <span>Budget Kms Parcourus</span>
      <input placeholder="valeur" type="number" class="input2" formControlName="budget_KmsParcourus" required>
      <h5 class="pop circle-icon">
        <u>Information sur les Besoins :</u>
      </h5>
      <span>Besoins Usm</span>
      <input placeholder="valeur" type="number" class="input2" formControlName="besoinUsm" required>
      <span>Observation</span>
      <input placeholder="valeur"  type="text" class="input2" formControlName="observation" required>
      <span>CSR id</span>
      <input placeholder="valeur" type="number" class="input2" formControlName="csr_id" required>
      <div class="button-container">
      <button *ngIf="!isDataSaved" type="submit" [disabled]="myressoure.invalid || isDataSaved" class=" button1 btn1 " >Send</button>
      <div class="success1" *ngIf="isDataSaved">
        <div class="check">
          <mat-icon>check</mat-icon>
        </div>
        <span class="enrg">
        Enregisté
        </span>

      </div>
      <button  class=" button1 btn1 keyboard" *ngIf="isDataSaved"  (click)="openModal()">
        <mat-icon>keyboard_tab</mat-icon>
      </button>
      </div>
      <button  type="button"  (click)="updateLastRecord()" class=" button1 btn1 " *ngIf="isDataSaved">Update data</button>

      <button type="button" *ngIf="isDataSaved" (click)="DeleteLastData()" class=" button1 btn1 ">
        <svg  xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
          <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"/>
          <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"/>
        </svg>
      </button>
  </div>
</form>
</div>
<br>

<div class="Tablecontainer "  *ngIf="!isTableVisible && isDataSaved" #test>
  <table *ngIf="tableData.length > 0 " id="data-table" class="table custom-table " >
    <thead>
      <tr>
        <th>Ressources</th>
        <th>Valeur</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of tableData">
        <td>Année</td>
        <td>{{ data.year }}</td>
        </tr>
        <tr *ngFor="let data of tableData">
          <td>vehicule id</td>
        <td>{{ data.vehicule_id }}</td>
        </tr>
        <tr *ngFor="let data of tableData">
          <td>Type de vehicule</td>
        <td>{{ data.vehicule_type}}</td>
       </tr>
        <tr *ngFor="let data of tableData">
          <td>Age de vehicule</td>
        <td>{{ data.vehicule_age }}</td>
       </tr>
       <tr *ngFor="let data of tableData">
        <td>Budget id</td>
        <td>{{ data.budget_id }}</td>
        </tr>
        <tr *ngFor="let data of tableData">
          <td>Budget des kilometres parcourus</td>
        <td>{{ data.budget_KmsParcourus }}</td>
        </tr>
        <tr *ngFor="let data of tableData">
          <td>Besoins Usm</td>
        <td>{{ data.besoinUsm }}</td>
        </tr>
        <tr *ngFor="let data of tableData">
          <td>Observation</td>
        <td>{{ data.observation }}</td>
        </tr>
        <tr *ngFor="let data of tableData">
          <td>CSR id</td>
        <td>{{ data.csr_id }}</td>
        </tr>


    </tbody>
  </table>
</div>

<button type="button" *ngIf="!isTableVisible && isDataSaved" (click)="downloadTableAsPDF()" class="button1 btn1">Download PDF</button>

<div class="Tablecontainer" *ngIf="isTableVisible && isDataSaved"  #test>
  <table *ngIf="updatedTableData.length > 0 " id="updated-data-table" class="table custom-table " >
    <thead>
      <tr>
        <th>Année</th>
        <th>Vehicule id</th>
        <th>Type Vehicule</th>
        <th>Budget id</th>
        <th>Budget des Kms Parcourus</th>
        <th>Besoins des Usm</th>
        <th>Observation 1</th>
        <th>Centre de santé id</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of updatedTableData">
        <td>{{ data.year }}</td>
        <td>{{ data.vehicule_id }}</td>
        <td>{{ data.vehicule_type }}</td>
        <td>{{ data.budget_id }}</td>
        <td>{{ data.budget_KmsParcourus }}</td>
        <td>{{ data.besoinUsm }}</td>
        <td>{{ data.observation }}</td>
        <td>{{ data.csr_id }}</td>

      </tr>
    </tbody>
  </table>
</div>
<button type="button" *ngIf="isTableVisible && isDataSaved" (click)="downloadTableAsPDF()" class="button1 btn1">Download PDF</button>


